<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Linear and curve-linear relationships, and predictions | Quantitative methods and statistics (In Sport and Exercise Science)</title>
  <meta name="description" content="These course notes let’s you follow along in the course Quantitative methods and Statistics (IDR4000) as given at the Section for Health and Exercise Physiology, Inland University of Applied Sciences. Cover image Created with BioRender.com." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Linear and curve-linear relationships, and predictions | Quantitative methods and statistics (In Sport and Exercise Science)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="These course notes let’s you follow along in the course Quantitative methods and Statistics (IDR4000) as given at the Section for Health and Exercise Physiology, Inland University of Applied Sciences. Cover image Created with BioRender.com." />
  <meta name="github-repo" content="dhammarstrom/quant-methods" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Linear and curve-linear relationships, and predictions | Quantitative methods and statistics (In Sport and Exercise Science)" />
  
  <meta name="twitter:description" content="These course notes let’s you follow along in the course Quantitative methods and Statistics (IDR4000) as given at the Section for Health and Exercise Physiology, Inland University of Applied Sciences. Cover image Created with BioRender.com." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Daniel Hammarström" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-linear-model.html"/>
<link rel="next" href="categorical-predictors-and-multiple-regression.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative methods and statistics (In Sport and Exercise Science)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#quick-links"><i class="fa fa-check"></i><b>1.1</b> Quick links:</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#practical-information"><i class="fa fa-check"></i><b>1.2</b> Practical information</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>1.2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#learning-strategies"><i class="fa fa-check"></i><b>1.2.2</b> Learning strategies</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#course-evaluation"><i class="fa fa-check"></i><b>1.2.3</b> Course evaluation</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#lecturers-and-course-administration"><i class="fa fa-check"></i><b>1.2.4</b> Lecturers and course administration</a></li>
<li class="chapter" data-level="1.2.5" data-path="index.html"><a href="index.html#updates-notifications-and-general-communication"><i class="fa fa-check"></i><b>1.2.5</b> Updates, notifications and general communication</a></li>
<li class="chapter" data-level="1.2.6" data-path="index.html"><a href="index.html#literature"><i class="fa fa-check"></i><b>1.2.6</b> Literature</a></li>
<li class="chapter" data-level="1.2.7" data-path="index.html"><a href="index.html#grades"><i class="fa fa-check"></i><b>1.2.7</b> Grades</a></li>
<li class="chapter" data-level="1.2.8" data-path="index.html"><a href="index.html#language"><i class="fa fa-check"></i><b>1.2.8</b> Language</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#assignments-and-portfolio-exam"><i class="fa fa-check"></i><b>1.3</b> Assignments and Portfolio exam</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#other-information"><i class="fa fa-check"></i><b>1.4</b> Other information</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-data-science.html"><a href="introduction-to-data-science.html"><i class="fa fa-check"></i><b>2</b> Introduction to data science</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-data-science.html"><a href="introduction-to-data-science.html#about-data-in-the-world-of-sport-and-exercise"><i class="fa fa-check"></i><b>2.1</b> About data in the world of sport and exercise</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-data-science.html"><a href="introduction-to-data-science.html#replication-and-reproducibility"><i class="fa fa-check"></i><b>2.2</b> Replication and Reproducibility</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-data-science.html"><a href="introduction-to-data-science.html#tools-in-data-science"><i class="fa fa-check"></i><b>2.3</b> Tools in data science</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="storing-data-in-spreadsheets.html"><a href="storing-data-in-spreadsheets.html"><i class="fa fa-check"></i><b>3</b> Storing data in spreadsheets</a>
<ul>
<li class="chapter" data-level="3.1" data-path="storing-data-in-spreadsheets.html"><a href="storing-data-in-spreadsheets.html#cells-and-simple-functions"><i class="fa fa-check"></i><b>3.1</b> Cells and simple functions</a></li>
<li class="chapter" data-level="3.2" data-path="storing-data-in-spreadsheets.html"><a href="storing-data-in-spreadsheets.html#tidy-data-and-data-storage"><i class="fa fa-check"></i><b>3.2</b> Tidy data and data storage</a></li>
<li class="chapter" data-level="3.3" data-path="storing-data-in-spreadsheets.html"><a href="storing-data-in-spreadsheets.html#recording-data"><i class="fa fa-check"></i><b>3.3</b> Recording data</a></li>
<li class="chapter" data-level="3.4" data-path="storing-data-in-spreadsheets.html"><a href="storing-data-in-spreadsheets.html#saving-data"><i class="fa fa-check"></i><b>3.4</b> Saving data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html"><i class="fa fa-check"></i><b>4</b> Installing and starting up R (and R Studio)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#installing-r"><i class="fa fa-check"></i><b>4.1</b> Installing R</a></li>
<li class="chapter" data-level="4.2" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#installing-r-studio"><i class="fa fa-check"></i><b>4.2</b> Installing R Studio</a></li>
<li class="chapter" data-level="4.3" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#getting-to-know-r-and-rstudio"><i class="fa fa-check"></i><b>4.3</b> Getting to know R and RStudio</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#the-source"><i class="fa fa-check"></i><b>4.3.1</b> The source</a></li>
<li class="chapter" data-level="4.3.2" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#environment"><i class="fa fa-check"></i><b>4.3.2</b> Environment</a></li>
<li class="chapter" data-level="4.3.3" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#the-console"><i class="fa fa-check"></i><b>4.3.3</b> The console</a></li>
<li class="chapter" data-level="4.3.4" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#files-plots-packages-and-help-files"><i class="fa fa-check"></i><b>4.3.4</b> Files, plots, packages and help files</a></li>
<li class="chapter" data-level="4.3.5" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#customizing-the-apperance-of-rstudio"><i class="fa fa-check"></i><b>4.3.5</b> Customizing the apperance of RStudio</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#reproducible-computing"><i class="fa fa-check"></i><b>4.4</b> Reproducible computing</a></li>
<li class="chapter" data-level="4.5" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#packages"><i class="fa fa-check"></i><b>4.5</b> Packages</a></li>
<li class="chapter" data-level="4.6" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#installing-and-using-swirl"><i class="fa fa-check"></i><b>4.6</b> Installing and using <code>swirl</code></a></li>
<li class="chapter" data-level="4.7" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#r-scripts"><i class="fa fa-check"></i><b>4.7</b> R scripts</a></li>
<li class="chapter" data-level="4.8" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#r-markdown-files"><i class="fa fa-check"></i><b>4.8</b> R markdown files</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#starting-up-your-first-r-markdown-file"><i class="fa fa-check"></i><b>4.8.1</b> Starting up your first R markdown file</a></li>
<li class="chapter" data-level="4.8.2" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#microsoft-word-intergration"><i class="fa fa-check"></i><b>4.8.2</b> Microsoft Word intergration</a></li>
<li class="chapter" data-level="4.8.3" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#adding-references"><i class="fa fa-check"></i><b>4.8.3</b> Adding references</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html"><i class="fa fa-check"></i><b>5</b> Creating your first graph</a>
<ul>
<li class="chapter" data-level="5.1" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#resources"><i class="fa fa-check"></i><b>5.1</b> Resources</a></li>
<li class="chapter" data-level="5.2" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#learning-objectives-1"><i class="fa fa-check"></i><b>5.2</b> Learning objectives</a></li>
<li class="chapter" data-level="5.3" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#prerequisites"><i class="fa fa-check"></i><b>5.3</b> Prerequisites</a></li>
<li class="chapter" data-level="5.4" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#the-ggplot2-system"><i class="fa fa-check"></i><b>5.4</b> The <code>ggplot2</code> system</a></li>
<li class="chapter" data-level="5.5" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#different-geoms-using-real-data"><i class="fa fa-check"></i><b>5.5</b> Different geoms using real data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#a-plot-of-values-per-group"><i class="fa fa-check"></i><b>5.5.1</b> A plot of values per group</a></li>
<li class="chapter" data-level="5.5.2" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#data-over-time-per-group-and-individual"><i class="fa fa-check"></i><b>5.5.2</b> Data over time per group and individual</a></li>
<li class="chapter" data-level="5.5.3" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#titles-and-labels"><i class="fa fa-check"></i><b>5.5.3</b> Titles and labels</a></li>
<li class="chapter" data-level="5.5.4" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#annotations"><i class="fa fa-check"></i><b>5.5.4</b> Annotations</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#themes"><i class="fa fa-check"></i><b>5.6</b> Themes</a></li>
<li class="chapter" data-level="5.7" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#test-your-understandning"><i class="fa fa-check"></i><b>5.7</b> Test your understandning</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html"><i class="fa fa-check"></i><b>6</b> Wrangling data to create your first table</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#resources-1"><i class="fa fa-check"></i><b>6.0.1</b> Resources</a></li>
<li class="chapter" data-level="6.1" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#making-table-1"><i class="fa fa-check"></i><b>6.1</b> Making “Table 1”</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#the-pipe-operator-and-select"><i class="fa fa-check"></i><b>6.1.1</b> The pipe operator and select</a></li>
<li class="chapter" data-level="6.1.2" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#filter-observations"><i class="fa fa-check"></i><b>6.1.2</b> Filter observations</a></li>
<li class="chapter" data-level="6.1.3" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#create-or-change-variables"><i class="fa fa-check"></i><b>6.1.3</b> Create or change variables</a></li>
<li class="chapter" data-level="6.1.4" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#grouped-operations-and-summary-statistics"><i class="fa fa-check"></i><b>6.1.4</b> Grouped operations and summary statistics</a></li>
<li class="chapter" data-level="6.1.5" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#starting-the-table-generator---the-kable-function"><i class="fa fa-check"></i><b>6.1.5</b> Starting the table generator - The <code>kable</code> function</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#summary"><i class="fa fa-check"></i><b>6.2</b> Summary</a></li>
<li class="chapter" data-level="6.3" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#flextable"><i class="fa fa-check"></i><b>6.3</b> Flextable</a></li>
<li class="chapter" data-level="6.4" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#an-exercise-reproduce-table-1-from-rn2225"><i class="fa fa-check"></i><b>6.4</b> An exercise, reproduce Table 1 from <span class="citation">(<span>Haun et al. 2019</span>)</span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="writing-your-first-reproducible-report.html"><a href="writing-your-first-reproducible-report.html"><i class="fa fa-check"></i><b>7</b> Writing your first reproducible report</a>
<ul>
<li class="chapter" data-level="7.1" data-path="writing-your-first-reproducible-report.html"><a href="writing-your-first-reproducible-report.html#rstudio-projects-and-your-reproducible-report"><i class="fa fa-check"></i><b>7.1</b> RStudio projects and your reproducible report</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><i class="fa fa-check"></i><b>8</b> Version control and collaborative coding – introducing git and github.com</a>
<ul>
<li class="chapter" data-level="8.1" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#why-version-control"><i class="fa fa-check"></i><b>8.1</b> Why version control</a></li>
<li class="chapter" data-level="8.2" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#a-simplecomplicated-start"><i class="fa fa-check"></i><b>8.2</b> A simple/complicated start</a></li>
<li class="chapter" data-level="8.3" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#step-by-step-instructions-on-setting-up-a-version-controlled-r-project."><i class="fa fa-check"></i><b>8.3</b> Step by step instructions on setting up a version controlled R project.</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#step-1.-create-a-free-github-account"><i class="fa fa-check"></i><b>8.3.1</b> Step 1. Create a free github account:</a></li>
<li class="chapter" data-level="8.3.2" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#step-2.-download-git."><i class="fa fa-check"></i><b>8.3.2</b> Step 2. Download git.</a></li>
<li class="chapter" data-level="8.3.3" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#step-3.-connect-git-to-rstudio"><i class="fa fa-check"></i><b>8.3.3</b> Step 3. Connect git to RStudio</a></li>
<li class="chapter" data-level="8.3.4" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#step-4.-create-a-new-online-repository"><i class="fa fa-check"></i><b>8.3.4</b> Step 4. Create a new online repository</a></li>
<li class="chapter" data-level="8.3.5" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#step-5.-create-a-new-project-in-rstudio"><i class="fa fa-check"></i><b>8.3.5</b> Step 5. Create a new project in RStudio</a></li>
<li class="chapter" data-level="8.3.6" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#step-6.-make-changes-to-your-project"><i class="fa fa-check"></i><b>8.3.6</b> Step 6. Make changes to your project</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#forking-and-pull-requests"><i class="fa fa-check"></i><b>8.4</b> Forking and pull requests</a></li>
<li class="chapter" data-level="8.5" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#additional-great-things-about-github"><i class="fa fa-check"></i><b>8.5</b> Additional great things about GitHub</a></li>
<li class="chapter" data-level="8.6" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#when-will-this-knowledge-be-handy"><i class="fa fa-check"></i><b>8.6</b> When will this knowledge be handy?</a></li>
<li class="chapter" data-level="8.7" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html#resources-2"><i class="fa fa-check"></i><b>8.7</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="reliability-in-the-physiology-lab.html"><a href="reliability-in-the-physiology-lab.html"><i class="fa fa-check"></i><b>9</b> Reliability in the physiology lab</a>
<ul>
<li class="chapter" data-level="9.1" data-path="reliability-in-the-physiology-lab.html"><a href="reliability-in-the-physiology-lab.html#smallest-worthwhile-change-or-effect"><i class="fa fa-check"></i><b>9.1</b> Smallest worthwhile change or effect</a></li>
<li class="chapter" data-level="9.2" data-path="reliability-in-the-physiology-lab.html"><a href="reliability-in-the-physiology-lab.html#video-from-seminar"><i class="fa fa-check"></i><b>9.2</b> Video from seminar</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="assignment1.html"><a href="assignment1.html"><i class="fa fa-check"></i><b>10</b> Assignment 1: Reliability and tools for reproducible data science</a>
<ul>
<li class="chapter" data-level="10.1" data-path="assignment1.html"><a href="assignment1.html#elements-of-the-report"><i class="fa fa-check"></i><b>10.1</b> Elements of the report</a></li>
<li class="chapter" data-level="10.2" data-path="assignment1.html"><a href="assignment1.html#the-format-of-the-report"><i class="fa fa-check"></i><b>10.2</b> The format of the report</a></li>
<li class="chapter" data-level="10.3" data-path="assignment1.html"><a href="assignment1.html#how-to-hand-in-the-report."><i class="fa fa-check"></i><b>10.3</b> How to hand in the report.</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="introduction-to-the-molecular-exercise-physiology-lab.html"><a href="introduction-to-the-molecular-exercise-physiology-lab.html"><i class="fa fa-check"></i><b>11</b> Introduction to the molecular exercise physiology lab</a>
<ul>
<li class="chapter" data-level="11.1" data-path="introduction-to-the-molecular-exercise-physiology-lab.html"><a href="introduction-to-the-molecular-exercise-physiology-lab.html#health-and-safety-in-the-lab"><i class="fa fa-check"></i><b>11.1</b> Health and safety in the lab</a></li>
<li class="chapter" data-level="11.2" data-path="introduction-to-the-molecular-exercise-physiology-lab.html"><a href="introduction-to-the-molecular-exercise-physiology-lab.html#good-laboratory-practice"><i class="fa fa-check"></i><b>11.2</b> Good laboratory practice</a></li>
<li class="chapter" data-level="11.3" data-path="introduction-to-the-molecular-exercise-physiology-lab.html"><a href="introduction-to-the-molecular-exercise-physiology-lab.html#the-laboratory-journal"><i class="fa fa-check"></i><b>11.3</b> The laboratory journal</a></li>
<li class="chapter" data-level="11.4" data-path="introduction-to-the-molecular-exercise-physiology-lab.html"><a href="introduction-to-the-molecular-exercise-physiology-lab.html#keeping-it-digital---using-our-electronic-lab-journal"><i class="fa fa-check"></i><b>11.4</b> Keeping it digital - Using our electronic lab journal</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="introduction-to-the-molecular-exercise-physiology-lab.html"><a href="introduction-to-the-molecular-exercise-physiology-lab.html#what-to-write-in-the-journal"><i class="fa fa-check"></i><b>11.4.1</b> What to write in the journal</a></li>
<li class="chapter" data-level="11.4.2" data-path="introduction-to-the-molecular-exercise-physiology-lab.html"><a href="introduction-to-the-molecular-exercise-physiology-lab.html#structure-of-an-entry"><i class="fa fa-check"></i><b>11.4.2</b> Structure of an entry</a></li>
<li class="chapter" data-level="11.4.3" data-path="introduction-to-the-molecular-exercise-physiology-lab.html"><a href="introduction-to-the-molecular-exercise-physiology-lab.html#relationship-between-the-laboratory-journal-and-your-samples-solutions-tubes-etc."><i class="fa fa-check"></i><b>11.4.3</b> Relationship between the laboratory journal and your samples, solutions, tubes etc.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="introduction-to-the-molecular-exercise-physiology-lab.html"><a href="introduction-to-the-molecular-exercise-physiology-lab.html#protocols-and-experiments-in-the-course"><i class="fa fa-check"></i><b>11.5</b> Protocols and experiments in the course</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>12</b> The linear model</a>
<ul>
<li class="chapter" data-level="12.1" data-path="the-linear-model.html"><a href="the-linear-model.html#resources-3"><i class="fa fa-check"></i><b>12.1</b> Resources</a></li>
<li class="chapter" data-level="12.2" data-path="the-linear-model.html"><a href="the-linear-model.html#straight-lines"><i class="fa fa-check"></i><b>12.2</b> Straight lines</a></li>
<li class="chapter" data-level="12.3" data-path="the-linear-model.html"><a href="the-linear-model.html#fitting-regression-models-in-r"><i class="fa fa-check"></i><b>12.3</b> Fitting regression models in R</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-relationship"><i class="fa fa-check"></i><b>12.3.1</b> Linear relationship</a></li>
<li class="chapter" data-level="12.3.2" data-path="the-linear-model.html"><a href="the-linear-model.html#constant-variance"><i class="fa fa-check"></i><b>12.3.2</b> Constant variance</a></li>
<li class="chapter" data-level="12.3.3" data-path="the-linear-model.html"><a href="the-linear-model.html#normal-residuals"><i class="fa fa-check"></i><b>12.3.3</b> Normal residuals</a></li>
<li class="chapter" data-level="12.3.4" data-path="the-linear-model.html"><a href="the-linear-model.html#independent-observations"><i class="fa fa-check"></i><b>12.3.4</b> Independent observations</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="the-linear-model.html"><a href="the-linear-model.html#check-the-results"><i class="fa fa-check"></i><b>12.4</b> Check the results</a></li>
<li class="chapter" data-level="12.5" data-path="the-linear-model.html"><a href="the-linear-model.html#a-note-about-printing-the-regression-table"><i class="fa fa-check"></i><b>12.5</b> A note about printing the regression table</a></li>
<li class="chapter" data-level="12.6" data-path="the-linear-model.html"><a href="the-linear-model.html#interpreting-the-results"><i class="fa fa-check"></i><b>12.6</b> Interpreting the results</a></li>
<li class="chapter" data-level="12.7" data-path="the-linear-model.html"><a href="the-linear-model.html#do-problematic-observations-matter"><i class="fa fa-check"></i><b>12.7</b> Do problematic observations matter?</a></li>
<li class="chapter" data-level="12.8" data-path="the-linear-model.html"><a href="the-linear-model.html#a-more-intepretable-model"><i class="fa fa-check"></i><b>12.8</b> A more intepretable model</a></li>
<li class="chapter" data-level="12.9" data-path="the-linear-model.html"><a href="the-linear-model.html#an-exercise"><i class="fa fa-check"></i><b>12.9</b> An exercise</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-and-curve-linear-relationships-and-predictions.html"><a href="linear-and-curve-linear-relationships-and-predictions.html"><i class="fa fa-check"></i><b>13</b> Linear and curve-linear relationships, and predictions</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-and-curve-linear-relationships-and-predictions.html"><a href="linear-and-curve-linear-relationships-and-predictions.html#predicting-from-data"><i class="fa fa-check"></i><b>13.1</b> Predicting from data</a></li>
<li class="chapter" data-level="13.2" data-path="linear-and-curve-linear-relationships-and-predictions.html"><a href="linear-and-curve-linear-relationships-and-predictions.html#the-workload-lactate-relationship"><i class="fa fa-check"></i><b>13.2</b> The workload-lactate relationship</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="categorical-predictors-and-multiple-regression.html"><a href="categorical-predictors-and-multiple-regression.html"><i class="fa fa-check"></i><b>14</b> Categorical predictors and multiple regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="categorical-predictors-and-multiple-regression.html"><a href="categorical-predictors-and-multiple-regression.html#linear-models-can-be-used-instead-of-t-tests"><i class="fa fa-check"></i><b>14.1</b> Linear models can be used instead of t-tests</a></li>
<li class="chapter" data-level="14.2" data-path="categorical-predictors-and-multiple-regression.html"><a href="categorical-predictors-and-multiple-regression.html#dummy-variables"><i class="fa fa-check"></i><b>14.2</b> Dummy variables</a></li>
<li class="chapter" data-level="14.3" data-path="categorical-predictors-and-multiple-regression.html"><a href="categorical-predictors-and-multiple-regression.html#multiple-regression"><i class="fa fa-check"></i><b>14.3</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i><b>15</b> Correlations</a>
<ul>
<li class="chapter" data-level="15.1" data-path="correlations.html"><a href="correlations.html#always-plot-the-data"><i class="fa fa-check"></i><b>15.1</b> Always plot the data!</a></li>
<li class="chapter" data-level="15.2" data-path="correlations.html"><a href="correlations.html#extending-the-correlation-to-the-regression"><i class="fa fa-check"></i><b>15.2</b> Extending the correlation to the regression</a></li>
<li class="chapter" data-level="15.3" data-path="correlations.html"><a href="correlations.html#correlation-comes-in-many-forms"><i class="fa fa-check"></i><b>15.3</b> Correlation comes in many forms</a></li>
<li class="chapter" data-level="15.4" data-path="correlations.html"><a href="correlations.html#statistical-and-subject-matter-interpretations"><i class="fa fa-check"></i><b>15.4</b> Statistical and subject-matter interpretations</a></li>
<li class="chapter" data-level="15.5" data-path="correlations.html"><a href="correlations.html#summary-1"><i class="fa fa-check"></i><b>15.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="study-questions.html"><a href="study-questions.html"><i class="fa fa-check"></i><b>16</b> Study questions</a>
<ul>
<li class="chapter" data-level="16.1" data-path="study-questions.html"><a href="study-questions.html#chapter-2-introduction-to-data-science-with-relevant-literature"><i class="fa fa-check"></i><b>16.1</b> Chapter 2: Introduction to data science (with relevant literature)</a></li>
<li class="chapter" data-level="16.2" data-path="study-questions.html"><a href="study-questions.html#chapter-3-storing-data-in-spreadsheets-with-relevant-literature"><i class="fa fa-check"></i><b>16.2</b> Chapter 3: Storing data in spreadsheets (with relevant literature)</a></li>
<li class="chapter" data-level="16.3" data-path="study-questions.html"><a href="study-questions.html#chapter-4-installing-and-starting-up-r-and-r-studio"><i class="fa fa-check"></i><b>16.3</b> Chapter 4: Installing and starting up R (and R Studio)</a></li>
<li class="chapter" data-level="16.4" data-path="study-questions.html"><a href="study-questions.html#chapter-5-creating-your-first-graph"><i class="fa fa-check"></i><b>16.4</b> Chapter 5: Creating your first graph</a></li>
<li class="chapter" data-level="16.5" data-path="study-questions.html"><a href="study-questions.html#chapter-6-wrangling-data-to-create-your-first-table"><i class="fa fa-check"></i><b>16.5</b> Chapter 6: Wrangling data to create your first table</a></li>
<li class="chapter" data-level="16.6" data-path="study-questions.html"><a href="study-questions.html#chapter-11-introduction-to-the-molecular-exercise-physiology-lab"><i class="fa fa-check"></i><b>16.6</b> Chapter 11: Introduction to the molecular exercise physiology lab</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>17</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative methods and statistics (In Sport and Exercise Science)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-and-curve-linear-relationships-and-predictions" class="section level1" number="13">
<h1><span class="header-section-number">Chapter 13</span> Linear and curve-linear relationships, and predictions</h1>
<p>In the previous chapter we looked at linear relationships, we can imagine these as straight lines. Many things in life are not straight. In this chapter we will add curve-linear relationships to our repertoire. We will start by predicting values.</p>
<div id="predicting-from-data" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Predicting from data</h2>
<p>Because of the relationship between inner dimension and our height, we might expect to see a relationship between body height and VO<sub>2max</sub>.The idea is that we will build a model and use this model to make <em>predictions</em> of our outcome with new data. Later we will hopefully see that this is one of the meany benefits of the powerful regression model technique.</p>
<p>As a first step, it is a good idea to get a visual representation of the prospective model. In the code chunk below we load the <code>cyclingstudy</code> data set from the <code>exscidata</code> package together with loading <code>tidyverse</code>. We then plot the relationship between <code>height</code> and <code>VO2.max</code>. In the <code>ggplot</code> call, a good starting point is to use <code>geom_point</code> together with <code>geom_smooth</code> which will produce a scatter plot with a best fit line. Notice that <code>method = "lm"</code> and <code>se = FALSE</code> are being used to make sure you get a straight line (<code>method = "lm"</code>) and no confidence bands (<code>se = FALSE</code>). Copy the code into your own document and run the code.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb105-2"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exscidata)</span>
<span id="cb105-3"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;cyclingstudy&quot;</span>)</span>
<span id="cb105-4"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A simple plot of the associtaion</span></span>
<span id="cb105-6"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb105-6" aria-hidden="true" tabindex="-1"></a>cyclingstudy <span class="sc">%&gt;%</span></span>
<span id="cb105-7"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb105-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(timepoint <span class="sc">==</span> <span class="st">&quot;pre&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-8"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb105-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(subject, group, VO2.max, <span class="at">height =</span> height.T1)  <span class="sc">%&gt;%</span></span>
<span id="cb105-9"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb105-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(height, VO2.max)) <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>We will now construct the model. The <code>lm</code> function (for linear model) take a formula and a data set in its simplest form. We have to save the output of the model in an object to be able to work with it down the line. In the code below I suggest storing the model object as <code>m1</code>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store the data set needed in the model fitting </span></span>
<span id="cb106-2"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb106-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> cyclingstudy <span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb106-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(timepoint <span class="sc">==</span> <span class="st">&quot;pre&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb106-4"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb106-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(subject, group, VO2.max, <span class="at">height =</span> height.T1)  <span class="sc">%&gt;%</span></span>
<span id="cb106-5"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb106-6"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model </span></span>
<span id="cb106-8"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb106-8" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(VO2.max <span class="sc">~</span> height, <span class="at">data =</span> dat)</span></code></pre></div>
<p>The above code will have stored an object in your environment. Using this object we may now make predictions. The manual way of making prediction would be to get the coefficients from the model an use them with new data. In the code chunk below I retrieve coefficients from the model representing the intercept and slope of the model. Remembering the basic mathematics of this simple model tells us that we can predict VO<sub>2max</sub> using the estimates from the model. These estimates can be retrieved using <code>coef()</code>. The intercept will be the first coefficient (<code>coef(m1)[1]</code>) and the slope will be the second (<code>coef(m1)[2]</code>). Adding the together an multiplying the slope with our new data will get us the prediction.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb107-1" aria-hidden="true" tabindex="-1"></a>new_height <span class="ot">&lt;-</span> <span class="dv">185</span></span>
<span id="cb107-2"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb107-3" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(m1)[<span class="dv">2</span>] <span class="sc">*</span> new_height </span></code></pre></div>
<p>R has some built in functions for these kind of operations. The <code>predict</code> function can be used to calculate what each observation would look like if it were “on the regression line.” Using predict on the model without any new data will give you the same values as the <code>fitted</code> function, try it out!</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store output</span></span>
<span id="cb108-2"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb108-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span>  <span class="fu">predict</span>(m1)</span>
<span id="cb108-3"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb108-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fitted</span>(m1)</span>
<span id="cb108-4"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the values</span></span>
<span id="cb108-6"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(pred, fit) <span class="sc">%&gt;%</span></span>
<span id="cb108-7"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pred, fit)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><code>predict</code> has an argument called <code>newdata</code>, here we can use a new data frame with the same predictors as in the data set used to fit the model. Using this new data set we may do several predictions from our model.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New Data Frame containing data we want to predict with </span></span>
<span id="cb109-2"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb109-2" aria-hidden="true" tabindex="-1"></a>ndf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">height =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">170</span>, <span class="dv">180</span>, <span class="dv">190</span>))</span>
<span id="cb109-3"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb109-4" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1, <span class="at">newdata =</span> ndf)</span></code></pre></div>
<p>Unsurprisingly, an increased height gives us higher predictions of VO<sub>2max</sub>. What would be your VO<sub>2max</sub> given this model.</p>
</div>
<div id="the-workload-lactate-relationship" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> The workload-lactate relationship</h2>
<p>In the <code>cyclingstudy</code> data set, data from lactate threshold tests are recorded for each participant. We need to “wrangle” the data set a bit to get the data in a format more suitable for analysis. In the code below I will first <code>select</code> columns needed for the analyses and the <code>filter</code> to retain one participant and one time-point. These data are then converted from a wide to long (tidy) format using the <code>pivot_longer</code> function. Notice that each of the lactate columns starts with <code>lac.</code>, this information can be used in <code>pivot_longer</code> when rearranging the data. In <code>pivot_longer</code> we also convert the values to numeric values using <code>as.numeric</code>. Finally, we plot the data.</p>
<p>The resulting plot (also shown below), shows a point for every lactate measurement. We have also connected the dots with <code>geom_line</code> which draws straight lines between each point. The straight line can be used to <em>interpolate</em> values between the observed lactate values. This is a common technique to calculate a lactate threshold, often defined as the intensity at 4 mmol L<up>-1<sup>.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb110-2"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exscidata)</span>
<span id="cb110-3"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;cyclingstudy&quot;</span>)</span>
<span id="cb110-5"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-7" aria-hidden="true" tabindex="-1"></a>cyclingstudy <span class="sc">%&gt;%</span></span>
<span id="cb110-8"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select columns needed for analysis</span></span>
<span id="cb110-9"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject, group, timepoint, lac<span class="fl">.225</span><span class="sc">:</span>lac<span class="fl">.375</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-10"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only one participant and time-point</span></span>
<span id="cb110-11"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(timepoint <span class="sc">==</span> <span class="st">&quot;pre&quot;</span>, subject <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-12"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot to long format data using the lactate columns</span></span>
<span id="cb110-13"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&quot;watt&quot;</span>, </span>
<span id="cb110-14"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;lactate&quot;</span>, </span>
<span id="cb110-15"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;lac.&quot;</span>,</span>
<span id="cb110-16"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">watt =</span> as.numeric),</span>
<span id="cb110-17"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">cols =</span> lac<span class="fl">.225</span><span class="sc">:</span>lac<span class="fl">.375</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-18"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the data, group = subject needed to connect the points</span></span>
<span id="cb110-19"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(watt, lactate, <span class="at">group =</span> subject))  <span class="sc">+</span> </span>
<span id="cb110-20"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb110-21"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb110-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">size =</span> <span class="fl">2.5</span>) </span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-79"></span>
<img src="quant-methods_files/figure-html/unnamed-chunk-79-1.png" alt="A workload and lactate relationship" width="672" />
<p class="caption">
Figure 13.1: A workload and lactate relationship
</p>
</div>
<p>Next figure shows the value of <em>x</em> (watt, intensity) when <em>y</em> (lactate) is set to 4. The lines are added by eyeballing<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a> the expected value. This is all fine, we have an approximate lactate threshold.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-1" aria-hidden="true" tabindex="-1"></a>cyclingstudy <span class="sc">%&gt;%</span></span>
<span id="cb111-2"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select columns needed for analysis</span></span>
<span id="cb111-3"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject, group, timepoint, lac<span class="fl">.225</span><span class="sc">:</span>lac<span class="fl">.375</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-4"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only one participant and time-point</span></span>
<span id="cb111-5"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(timepoint <span class="sc">==</span> <span class="st">&quot;pre&quot;</span>, subject <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-6"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot to long format data using the lactate columns</span></span>
<span id="cb111-7"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&quot;watt&quot;</span>, </span>
<span id="cb111-8"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;lactate&quot;</span>, </span>
<span id="cb111-9"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;lac.&quot;</span>,</span>
<span id="cb111-10"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">watt =</span> as.numeric),</span>
<span id="cb111-11"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">cols =</span> lac<span class="fl">.225</span><span class="sc">:</span>lac<span class="fl">.375</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-12"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the data, group = subject needed to connect the points</span></span>
<span id="cb111-13"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(watt, lactate, <span class="at">group =</span> subject))  <span class="sc">+</span> </span>
<span id="cb111-14"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb111-15"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb111-16"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding straight lines at specific values</span></span>
<span id="cb111-17"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb111-18"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb111-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">341.5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-80"></span>
<img src="quant-methods_files/figure-html/unnamed-chunk-80-1.png" alt="Interpolation to estimate the lactate threshold, exercise intensity at 4 mmol L&lt;sup&gt;-1&lt;/sup&gt;" width="672" />
<p class="caption">
Figure 13.2: Interpolation to estimate the lactate threshold, exercise intensity at 4 mmol L<sup>-1</sup>
</p>
</div>
<p>To get a better approximation, we could make use of the curve-linear relationship between exercise intensity and lactate accumulation. The “curvier” the relationship, the more wrong the above approximation would be (as Yoda say, would)<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a>. We can add a curve-linear model on top of our plot using the <code>geom_smooth</code> function in our <code>ggplot</code> call. In the code below, we will actually use several polynomial models together with a straight line to assess their fit.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-1" aria-hidden="true" tabindex="-1"></a>cyclingstudy <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select columns needed for analysis</span></span>
<span id="cb112-3"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject, group, timepoint, lac<span class="fl">.225</span><span class="sc">:</span>lac<span class="fl">.375</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-4"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only one participant and time-point</span></span>
<span id="cb112-5"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(timepoint <span class="sc">==</span> <span class="st">&quot;pre&quot;</span>, subject <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-6"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot to long format data using the lactate columns</span></span>
<span id="cb112-7"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&quot;watt&quot;</span>, </span>
<span id="cb112-8"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;lactate&quot;</span>, </span>
<span id="cb112-9"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;lac.&quot;</span>,</span>
<span id="cb112-10"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">watt =</span> as.numeric),</span>
<span id="cb112-11"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">cols =</span> lac<span class="fl">.225</span><span class="sc">:</span>lac<span class="fl">.375</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-12"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the data, group = subject needed to connect the points</span></span>
<span id="cb112-13"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(watt, lactate, <span class="at">group =</span> subject))  <span class="sc">+</span> </span>
<span id="cb112-14"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb112-15"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb112-16"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-17"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">341.5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-18"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding a straight line from a linear model</span></span>
<span id="cb112-19"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">color =</span> <span class="st">&quot;#e41a1c&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-20"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb112-21"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding a polynomial linear model to the plot</span></span>
<span id="cb112-22"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb112-23"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># poly(x, 2) add a second degree polynomial model.</span></span>
<span id="cb112-24"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">color =</span> <span class="st">&quot;#377eb8&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-25"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># poly(x, 3) add a third degree polynomial model.</span></span>
<span id="cb112-26"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>), <span class="at">color =</span> <span class="st">&quot;#4daf4a&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-27"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># poly(x, 4) add a forth degree polynomial model.</span></span>
<span id="cb112-28"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb112-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">4</span>), <span class="at">color =</span> <span class="st">&quot;#ff7f00&quot;</span>) </span></code></pre></div>
<p><img src="quant-methods_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb113-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># #fee090 represent color codes in th HEX format, palettes for different color can be found </span></span>
<span id="cb113-2"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here: https://colorbrewer2.org/</span></span></code></pre></div>
<p>As we can see in the resulting plot, the different models are not that different around the 4 mmol L<sup>-1</sup> mark. However, the linear model is just wrong at around 300 watts, the second degree polynomial model is wrong at 275 watts. The third and forth degree polynomial model does not differ much from observed values or each other.</p>
<p>We may fit these models formally using <code>lm</code> and check their residuals. First we will store the data set in an object called <code>lactate</code> and the use this data set in several <code>lm</code> calls. The same formula can be used as in <code>geom_smooth</code>, but we must use the actual variable names.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-1" aria-hidden="true" tabindex="-1"></a>lactate <span class="ot">&lt;-</span> cyclingstudy <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select columns needed for analysis</span></span>
<span id="cb114-3"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject, group, timepoint, lac<span class="fl">.225</span><span class="sc">:</span>lac<span class="fl">.375</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-4"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only one participant and time-point</span></span>
<span id="cb114-5"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(timepoint <span class="sc">==</span> <span class="st">&quot;pre&quot;</span>, subject <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-6"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot to long format data using the lactate columns</span></span>
<span id="cb114-7"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&quot;watt&quot;</span>, </span>
<span id="cb114-8"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;lactate&quot;</span>, </span>
<span id="cb114-9"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;lac.&quot;</span>,</span>
<span id="cb114-10"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">watt =</span> as.numeric),</span>
<span id="cb114-11"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">cols =</span> lac<span class="fl">.225</span><span class="sc">:</span>lac<span class="fl">.375</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-12"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove NA (missing) values to avoid warning/error messages.</span></span>
<span id="cb114-13"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lactate))</span>
<span id="cb114-14"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-15"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="co"># fit &quot;straight line&quot; model</span></span>
<span id="cb114-16"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-16" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lactate <span class="sc">~</span> watt, <span class="at">data =</span> lactate)</span>
<span id="cb114-17"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-18"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="co"># fit second degree polynomial</span></span>
<span id="cb114-19"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-19" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lactate <span class="sc">~</span> <span class="fu">poly</span>(watt, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> lactate)</span>
<span id="cb114-20"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-21"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-21" aria-hidden="true" tabindex="-1"></a><span class="co"># fit third degree polynomial</span></span>
<span id="cb114-22"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-22" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lactate <span class="sc">~</span> <span class="fu">poly</span>(watt, <span class="dv">3</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> lactate)</span>
<span id="cb114-23"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-24"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-24" aria-hidden="true" tabindex="-1"></a><span class="co"># fit forth degree polynomial</span></span>
<span id="cb114-25"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-25" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lactate <span class="sc">~</span> <span class="fu">poly</span>(watt, <span class="dv">4</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> lactate)</span>
<span id="cb114-26"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-27"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Store all residuals as new variables</span></span>
<span id="cb114-28"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-28" aria-hidden="true" tabindex="-1"></a>lactate<span class="sc">$</span>resid.m1 <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1)</span>
<span id="cb114-29"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-29" aria-hidden="true" tabindex="-1"></a>lactate<span class="sc">$</span>resid.m2 <span class="ot">&lt;-</span> <span class="fu">resid</span>(m2)</span>
<span id="cb114-30"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-30" aria-hidden="true" tabindex="-1"></a>lactate<span class="sc">$</span>resid.m3 <span class="ot">&lt;-</span> <span class="fu">resid</span>(m3)</span>
<span id="cb114-31"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-31" aria-hidden="true" tabindex="-1"></a>lactate<span class="sc">$</span>resid.m4 <span class="ot">&lt;-</span> <span class="fu">resid</span>(m4)</span>
<span id="cb114-32"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-33"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-33" aria-hidden="true" tabindex="-1"></a>lactate <span class="sc">%&gt;%</span></span>
<span id="cb114-34"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gather all the data from the models</span></span>
<span id="cb114-35"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&quot;model&quot;</span>, </span>
<span id="cb114-36"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;residual&quot;</span>, </span>
<span id="cb114-37"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;resid.&quot;</span>, </span>
<span id="cb114-38"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-38" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">residual =</span> as.numeric), </span>
<span id="cb114-39"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-39" aria-hidden="true" tabindex="-1"></a>               <span class="at">cols =</span> resid.m1<span class="sc">:</span>resid.m4) <span class="sc">%&gt;%</span></span>
<span id="cb114-40"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot values with the observed watt on x axis and residual values at the y</span></span>
<span id="cb114-41"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(watt, residual, <span class="at">fill =</span> model)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb114-42"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-43"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># To set the same colors/fills as above we use scale fill manual</span></span>
<span id="cb114-44"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb114-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#e41a1c&quot;</span>, <span class="st">&quot;#377eb8&quot;</span>, <span class="st">&quot;#4daf4a&quot;</span>, <span class="st">&quot;#ff7f00&quot;</span>))</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-82"></span>
<img src="quant-methods_files/figure-html/unnamed-chunk-82-1.png" alt="Assessing the fit f different linear models on a exercise intensity to lactate accumulation relationship." width="672" />
<p class="caption">
Figure 13.3: Assessing the fit f different linear models on a exercise intensity to lactate accumulation relationship.
</p>
</div>
<p>The forth degree polynomial model finds the observed values best, followed by the third degree. This is not strange as the polynomial model with increased degrees has more flexibility to fit to the data. The problem with polynomial models is that you cannot fit a fort degree polynomial model with only four data points. You may also encount some over-fitting to, for example a bad measurement. Let’s settle for the third degree model.</p>
<p>The next step will be to predict <em>x</em> from <em>y</em>. Remember that we have modeled the effct of <em>x</em> on <em>y</em>, i.e. the effect of exercise intensity on lactate. Using <code>predict</code> we may easily predict a lactate value for a specific value of <code>watt</code>. Since we want the <em>inverse prediction</em> we have to use some tricks in our prediction. The code below creates a data set of intensity values <code>watt</code> using the <code>seq</code> function which basically creates a vector of number with a specific distance between them. We can tehn use this vector of numbers to predict lactate values and find the value closest to 4 mmol L<sup>-1</sup>.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># new data data frame</span></span>
<span id="cb115-2"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb115-2" aria-hidden="true" tabindex="-1"></a>ndf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">watt =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">225</span>, <span class="at">to =</span> <span class="dv">350</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="co"># high resolution, we can find the nearest10:th a watt</span></span>
<span id="cb115-3"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb115-4" aria-hidden="true" tabindex="-1"></a>ndf<span class="sc">$</span>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(m3, <span class="at">newdata =</span> ndf)</span>
<span id="cb115-5"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Which value of the predictions comes closest to our value of 4 mmol L-1?</span></span>
<span id="cb115-7"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co"># abs finds the absolute value, makes all values positive, </span></span>
<span id="cb115-8"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions - 4 givs an exact prediction of 4 mmol the value zero</span></span>
<span id="cb115-9"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="co"># filter the row which has the prediction - 4 equal to the minimal absolut difference between prediction and 4 mmol</span></span>
<span id="cb115-10"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb115-10" aria-hidden="true" tabindex="-1"></a>lactate_threshold <span class="ot">&lt;-</span> ndf <span class="sc">%&gt;%</span></span>
<span id="cb115-11"><a href="linear-and-curve-linear-relationships-and-predictions.html#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> <span class="dv">4</span>) <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> <span class="dv">4</span>)))</span></code></pre></div>
<p>Our best estimate of the lacatate threshold is 343. We have approximated the exercise intensity at a specific value of lactate.</p>
<p>There a several ways of doing such calculations, and many other concepts of lactate thresholds exists. Newell <span class="citation">(<a href="references.html#ref-RN228" role="doc-biblioref">Newell et al. 2007</a>)</span> has developed R code for calculating several of these concepts. The code is a bit old but can be <a href="http://www.nuigalway.ie/maths/jn/Lactate/html/lactate-r.html">found here</a>. Other have implemented R code in applications to calculate lactate thresholds, for example <a href="https://shiny.fmattioni.me/lactate/">lactate dashboard</a>.</p>
<p>Most techniques and concepts rely on an underlying regression model.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="19">
<li id="fn19"><p><a href="https://www.urbandictionary.com/define.php?term=eyeballing">“the act of eyeballing something is to measure or weigh something without any tools”</a><a href="linear-and-curve-linear-relationships-and-predictions.html#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p><a href="https://www.wikihow.com/Speak-Like-Yoda">If you follow this link, take a cup of coffe before continuing with the chapter.</a><a href="linear-and-curve-linear-relationships-and-predictions.html#fnref20" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-linear-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="categorical-predictors-and-multiple-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["quant-methods.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
