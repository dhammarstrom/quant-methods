<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Creating your first graph | Quantitative methods and statistics (In Sport and Exercise Science)</title>
  <meta name="description" content="These course notes let’s you follow along in the course Quantitative methods and Statistics (IDR4000) as given at the Section for Health and Exercise Physiology, Inland University of Applied Sciences. Cover image Created with BioRender.com." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Creating your first graph | Quantitative methods and statistics (In Sport and Exercise Science)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="These course notes let’s you follow along in the course Quantitative methods and Statistics (IDR4000) as given at the Section for Health and Exercise Physiology, Inland University of Applied Sciences. Cover image Created with BioRender.com." />
  <meta name="github-repo" content="dhammarstrom/quant-methods" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Creating your first graph | Quantitative methods and statistics (In Sport and Exercise Science)" />
  
  <meta name="twitter:description" content="These course notes let’s you follow along in the course Quantitative methods and Statistics (IDR4000) as given at the Section for Health and Exercise Physiology, Inland University of Applied Sciences. Cover image Created with BioRender.com." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Daniel Hammarström" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="installing-and-starting-up-r-and-r-studio.html"/>
<link rel="next" href="wrangling-data-to-create-your-first-table.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative methods and statistics (In Sport and Exercise Science)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#practical-information"><i class="fa fa-check"></i><b>1.1</b> Practical information</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>1.1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#learning-strategies"><i class="fa fa-check"></i><b>1.1.2</b> Learning strategies</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#course-evaluation"><i class="fa fa-check"></i><b>1.1.3</b> Course evaluation</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#lecturers-and-course-administration"><i class="fa fa-check"></i><b>1.1.4</b> Lecturers and course administration</a></li>
<li class="chapter" data-level="1.1.5" data-path="index.html"><a href="index.html#updates-notifications-and-general-communication"><i class="fa fa-check"></i><b>1.1.5</b> Updates, notifications and general communication</a></li>
<li class="chapter" data-level="1.1.6" data-path="index.html"><a href="index.html#literature"><i class="fa fa-check"></i><b>1.1.6</b> Literature</a></li>
<li class="chapter" data-level="1.1.7" data-path="index.html"><a href="index.html#grades"><i class="fa fa-check"></i><b>1.1.7</b> Grades</a></li>
<li class="chapter" data-level="1.1.8" data-path="index.html"><a href="index.html#language"><i class="fa fa-check"></i><b>1.1.8</b> Language</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#assignments-and-portfolio-exam"><i class="fa fa-check"></i><b>1.2</b> Assignments and Portfolio exam</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#other-information"><i class="fa fa-check"></i><b>1.3</b> Other information</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-data-science.html"><a href="introduction-to-data-science.html"><i class="fa fa-check"></i><b>2</b> Introduction to data science</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-data-science.html"><a href="introduction-to-data-science.html#about-data-in-the-world-of-sport-and-exercise"><i class="fa fa-check"></i><b>2.1</b> About data in the world of sport and exercise</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-data-science.html"><a href="introduction-to-data-science.html#replication-and-reproducibility"><i class="fa fa-check"></i><b>2.2</b> Replication and Reproducibility</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-data-science.html"><a href="introduction-to-data-science.html#tools-in-data-science"><i class="fa fa-check"></i><b>2.3</b> Tools in data science</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="storing-data-in-spreadsheets.html"><a href="storing-data-in-spreadsheets.html"><i class="fa fa-check"></i><b>3</b> Storing data in spreadsheets</a>
<ul>
<li class="chapter" data-level="3.1" data-path="storing-data-in-spreadsheets.html"><a href="storing-data-in-spreadsheets.html#cells-and-simple-functions"><i class="fa fa-check"></i><b>3.1</b> Cells and simple functions</a></li>
<li class="chapter" data-level="3.2" data-path="storing-data-in-spreadsheets.html"><a href="storing-data-in-spreadsheets.html#tidy-data-and-data-storage"><i class="fa fa-check"></i><b>3.2</b> Tidy data and data storage</a></li>
<li class="chapter" data-level="3.3" data-path="storing-data-in-spreadsheets.html"><a href="storing-data-in-spreadsheets.html#recording-data"><i class="fa fa-check"></i><b>3.3</b> Recording data</a></li>
<li class="chapter" data-level="3.4" data-path="storing-data-in-spreadsheets.html"><a href="storing-data-in-spreadsheets.html#saving-data"><i class="fa fa-check"></i><b>3.4</b> Saving data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html"><i class="fa fa-check"></i><b>4</b> Installing and starting up R (and R Studio)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#installing-r"><i class="fa fa-check"></i><b>4.1</b> Installing R</a></li>
<li class="chapter" data-level="4.2" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#installing-r-studio"><i class="fa fa-check"></i><b>4.2</b> Installing R Studio</a></li>
<li class="chapter" data-level="4.3" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#getting-to-know-r-and-rstudio"><i class="fa fa-check"></i><b>4.3</b> Getting to know R and RStudio</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#the-source"><i class="fa fa-check"></i><b>4.3.1</b> The source</a></li>
<li class="chapter" data-level="4.3.2" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#environment"><i class="fa fa-check"></i><b>4.3.2</b> Environment</a></li>
<li class="chapter" data-level="4.3.3" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#the-console"><i class="fa fa-check"></i><b>4.3.3</b> The console</a></li>
<li class="chapter" data-level="4.3.4" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#files-plots-packages-and-help-files"><i class="fa fa-check"></i><b>4.3.4</b> Files, plots, packages and help files</a></li>
<li class="chapter" data-level="4.3.5" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#customizing-the-apperance-of-rstudio"><i class="fa fa-check"></i><b>4.3.5</b> Customizing the apperance of RStudio</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#reproducible-computing"><i class="fa fa-check"></i><b>4.4</b> Reproducible computing</a></li>
<li class="chapter" data-level="4.5" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#packages"><i class="fa fa-check"></i><b>4.5</b> Packages</a></li>
<li class="chapter" data-level="4.6" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#installing-and-using-swirl"><i class="fa fa-check"></i><b>4.6</b> Installing and using <code>swirl</code></a></li>
<li class="chapter" data-level="4.7" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#r-scripts"><i class="fa fa-check"></i><b>4.7</b> R scripts</a></li>
<li class="chapter" data-level="4.8" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#r-markdown-files"><i class="fa fa-check"></i><b>4.8</b> R markdown files</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#starting-up-your-first-r-markdown-file"><i class="fa fa-check"></i><b>4.8.1</b> Starting up your first R markdown file</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#r-markdown"><i class="fa fa-check"></i><b>4.9</b> R Markdown</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#microsoft-word-intergration"><i class="fa fa-check"></i><b>4.9.1</b> Microsoft Word intergration</a></li>
<li class="chapter" data-level="4.9.2" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#adding-references"><i class="fa fa-check"></i><b>4.9.2</b> Adding references</a></li>
<li class="chapter" data-level="4.9.3" data-path="installing-and-starting-up-r-and-r-studio.html"><a href="installing-and-starting-up-r-and-r-studio.html#a-note-on-folder-structures"><i class="fa fa-check"></i><b>4.9.3</b> A note on folder structures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html"><i class="fa fa-check"></i><b>5</b> Creating your first graph</a>
<ul>
<li class="chapter" data-level="5.1" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#resources"><i class="fa fa-check"></i><b>5.1</b> Resources</a></li>
<li class="chapter" data-level="5.2" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#learning-objectives-1"><i class="fa fa-check"></i><b>5.2</b> Learning objectives</a></li>
<li class="chapter" data-level="5.3" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#prerequisites"><i class="fa fa-check"></i><b>5.3</b> Prerequisites</a></li>
<li class="chapter" data-level="5.4" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#the-ggplot2-system"><i class="fa fa-check"></i><b>5.4</b> The <code>ggplot2</code> system</a></li>
<li class="chapter" data-level="5.5" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#different-geoms-using-real-data"><i class="fa fa-check"></i><b>5.5</b> Different geoms using real data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#a-plot-of-values-per-group"><i class="fa fa-check"></i><b>5.5.1</b> A plot of values per group</a></li>
<li class="chapter" data-level="5.5.2" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#data-over-time-per-group-and-individual"><i class="fa fa-check"></i><b>5.5.2</b> Data over time per group and individual</a></li>
<li class="chapter" data-level="5.5.3" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#titles-and-labels"><i class="fa fa-check"></i><b>5.5.3</b> Titles and labels</a></li>
<li class="chapter" data-level="5.5.4" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#annotations"><i class="fa fa-check"></i><b>5.5.4</b> Annotations</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#themes"><i class="fa fa-check"></i><b>5.6</b> Themes</a></li>
<li class="chapter" data-level="5.7" data-path="creating-your-first-graph.html"><a href="creating-your-first-graph.html#test-your-understandning"><i class="fa fa-check"></i><b>5.7</b> Test your understandning</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html"><i class="fa fa-check"></i><b>6</b> Wrangling data to create your first table</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#resources-1"><i class="fa fa-check"></i><b>6.0.1</b> Resources</a></li>
<li class="chapter" data-level="6.1" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#making-table-1"><i class="fa fa-check"></i><b>6.1</b> Making “Table 1”</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#the-pipe-operator-and-select"><i class="fa fa-check"></i><b>6.1.1</b> The pipe operator and select</a></li>
<li class="chapter" data-level="6.1.2" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#filter-observations"><i class="fa fa-check"></i><b>6.1.2</b> Filter observations</a></li>
<li class="chapter" data-level="6.1.3" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#create-or-change-variables"><i class="fa fa-check"></i><b>6.1.3</b> Create or change variables</a></li>
<li class="chapter" data-level="6.1.4" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#grouped-operations-and-summary-statistics"><i class="fa fa-check"></i><b>6.1.4</b> Grouped operations and summary statistics</a></li>
<li class="chapter" data-level="6.1.5" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#starting-the-table-generator---the-kable-function"><i class="fa fa-check"></i><b>6.1.5</b> Starting the table generator - The <code>kable</code> function</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#summary"><i class="fa fa-check"></i><b>6.2</b> Summary</a></li>
<li class="chapter" data-level="6.3" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#flextable"><i class="fa fa-check"></i><b>6.3</b> Flextable</a></li>
<li class="chapter" data-level="6.4" data-path="wrangling-data-to-create-your-first-table.html"><a href="wrangling-data-to-create-your-first-table.html#an-exercise-reproduce-table-1-from"><i class="fa fa-check"></i><b>6.4</b> An exercise, reproduce Table 1 from</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="writing-your-first-reproducible-report.html"><a href="writing-your-first-reproducible-report.html"><i class="fa fa-check"></i><b>7</b> Writing your first reproducible report</a></li>
<li class="chapter" data-level="8" data-path="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><a href="version-control-and-collaborative-coding-introducing-git-and-github-com.html"><i class="fa fa-check"></i><b>8</b> Version control and collaborative coding – introducing git and github.com</a></li>
<li class="chapter" data-level="9" data-path="reliability-in-the-physiology-lab.html"><a href="reliability-in-the-physiology-lab.html"><i class="fa fa-check"></i><b>9</b> Reliability in the physiology lab</a></li>
<li class="chapter" data-level="10" data-path="assignment1.html"><a href="assignment1.html"><i class="fa fa-check"></i><b>10</b> Assignment 1: Reliability and tools for reproducible data science</a>
<ul>
<li class="chapter" data-level="10.1" data-path="assignment1.html"><a href="assignment1.html#elements-of-the-report"><i class="fa fa-check"></i><b>10.1</b> Elements of the report</a></li>
<li class="chapter" data-level="10.2" data-path="assignment1.html"><a href="assignment1.html#the-format-of-the-report"><i class="fa fa-check"></i><b>10.2</b> The format of the report</a></li>
<li class="chapter" data-level="10.3" data-path="assignment1.html"><a href="assignment1.html#how-to-hand-in-the-report."><i class="fa fa-check"></i><b>10.3</b> How to hand in the report.</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="introduction-to-the-molecular-exercise-physiology-lab.html"><a href="introduction-to-the-molecular-exercise-physiology-lab.html"><i class="fa fa-check"></i><b>11</b> Introduction to the molecular exercise physiology lab</a></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative methods and statistics (In Sport and Exercise Science)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="creating-your-first-graph" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Creating your first graph</h1>
<script language="javascript"> 
    function toggle(num) {
      var ele = document.getElementById("toggleText" + num);
      var text = document.getElementById("displayText" + num);
      if(ele.style.display == "block") {
        ele.style.display = "none";
        text.innerHTML = "show";
      }
      else {
        ele.style.display = "block";
        text.innerHTML = "hide";
      }
   } 
  </script>
<p>Data visualization is an efficient way of understanding data. By using graphs we can communicate characteristics of a data set that would have been impossible with a limited number of summary statistics (central tendencies, spread etc.). In Chapter 2 of his book <span class="citation">(<a href="references.html#ref-RN2902" role="doc-biblioref">Spiegelhalter 2019</a>)</span>, Spiegelhalter touches upon this fact when he describes different types of graphs and their use to understand different data sets. A great argument for the use of data visualization is the need to understand what factors might explain variation in a given data set <span class="citation">(<a href="references.html#ref-RN2902" role="doc-biblioref">Spiegelhalter 2019</a>)</span>. In this sense, data visualization can be thought of as an initial step in understanding data, data visualization as an exploratory tool.</p>
<p>RStudio is a powerful environment for data visualization. Together with R (that is excellent for creating graphs), you can create and preview figures that represents your data in RStudio.</p>
<p>R has got several systems for creating figures, plots, graphs. In this course, we will use <a href="https://ggplot2.tidyverse.org/">ggplot2</a>. Another system for plotting comes with the base installation of R. This is sometimes referred to as base R (<a href="https://rstudio-pubs-static.s3.amazonaws.com/84527_6b8334fd3d9348579681b24d156e7e9d.html">see this tutorial</a>, or <a href="http://www.sthda.com/english/wiki/r-base-graphs">this</a>. Another well described and used system is <a href="https://www.statmethods.net/advgraphs/trellis.html">lattice</a>. We choose ggplot2 because it works well with the <a href="https://www.tidyverse.org/">tidyverse</a>, and it is well described.</p>
<div id="resources" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Resources</h2>
<p>There are several good resources aimed at ggplot2:</p>
<ul>
<li><a href="https://r4ds.had.co.nz/data-visualisation.html">Chapter 4 in R for data science</a></li>
<li><a href="https://ggplot2-book.org/">The ggplot2 book</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf">The ggplot2 cheatsheet</a></li>
</ul>
</div>
<div id="learning-objectives-1" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Learning objectives</h2>
<p>After this session, you should be able to answer:</p>
<ul>
<li>What are geoms?</li>
<li>What is mapping data to aesthetics?</li>
<li>What are theme components?</li>
</ul>
<p>You should also be able to create your first graph.</p>
</div>
<div id="prerequisites" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Prerequisites</h2>
<p>To follow the exercises below you will need to some data. For the purpose of this course, I have created a package that contains the data sets we need. In this session we will work with the <code>cyclingstudy</code> data set. To install the package (<code>exscidata</code>) you will need another package called <code>remotes</code>.</p>
<p>The code below first checks if the package <code>remotes</code> is installed, or more specifically, if <code>"remotes"</code> cannot be found in the list of installed packages. Using the <code>if</code> function makes <code>install.packages(remotes)</code> conditional. If we do not find <code>"remotes"</code> among installed packages, then install <code>remotes</code>.</p>
<p>The next line of code does the same with the <code>exscidata</code> package. However, since the package is not on CRAN but hosted on github we will need to use <code>remotes</code> to install it. The part of the second line of code that says <code>remotes::install_github("dhammarstrom/exscidata")</code> uses the function <code>install_github</code> without loading the remotes package. The last line of the code below loads the package <code>exscidata</code> using the <code>library</code> function.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="creating-your-first-graph.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if remotes is not installed, if TRUE, install remotes</span></span>
<span id="cb16-2"><a href="creating-your-first-graph.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">&quot;remotes&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) <span class="fu">install.packages</span>(remotes)</span>
<span id="cb16-3"><a href="creating-your-first-graph.html#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="creating-your-first-graph.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if exscidata is not installed, if TRUE, install exscidata from github</span></span>
<span id="cb16-5"><a href="creating-your-first-graph.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">&quot;exscidata&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;dhammarstrom/exscidata&quot;</span>)</span>
<span id="cb16-6"><a href="creating-your-first-graph.html#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="creating-your-first-graph.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load exscidata</span></span>
<span id="cb16-8"><a href="creating-your-first-graph.html#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exscidata)</span></code></pre></div>
<p>Next we need to load the <code>tidyverse</code> package. This package in turn loads several packages that we will use when transforming data and making our figures. I will include the line of code that checks if the package is installed, if not R will download and install it. We subsequently load the package using <code>library</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="creating-your-first-graph.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if tidyverse is not installed, if TRUE, install remotes</span></span>
<span id="cb17-2"><a href="creating-your-first-graph.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">&quot;tidyverse&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) <span class="fu">install.packages</span>(tidyverse)</span>
<span id="cb17-3"><a href="creating-your-first-graph.html#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="creating-your-first-graph.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>We are now ready to explore the data set. But first we should talk about the main components of the <code>ggplot2</code> system.</p>
</div>
<div id="the-ggplot2-system" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> The <code>ggplot2</code> system</h2>
<p>When using the ggplot2 system we can think of the resulting graph as containing data that has been <em>mapped</em> to different coordinates, colors, shapes, sizes and other attributes that determines what is being visualized. We are using different geometric representations of the data in the visualization.</p>
<p>When we <em>map</em> data in ggplot we use a specific function, <code>aes()</code> (short for aesthetic). We will use this inside the main engine, <code>ggplot()</code>. For this first simple example we will create a data set. When you simulate data in R you can tell R what should be the starting point in the random number generator. Using <code>set.seed(100)</code> we can recreate the same numbers from what ever “number generator” we later use. In the example below, we use <code>rnorm()</code> to simulate numbers from a normal distribution. The settings <code>n = 10</code>, <code>mean = 0</code> and <code>sd = 1</code> we will simulate randomly picking 10 numbers from a distribution that has a mean of 0 and a standard deviation of 1. These numbers are stored in a data frame that as assigned to an object that we have named <code>dat</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="creating-your-first-graph.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99</span>)</span>
<span id="cb18-2"><a href="creating-your-first-graph.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="creating-your-first-graph.html#cb18-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), </span>
<span id="cb18-4"><a href="creating-your-first-graph.html#cb18-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>))</span></code></pre></div>
<p>The dataset consist of two variables. We will start by creating the canvas, this basically sets the border of the figure we want to create. The <code>ggplot()</code> function takes the dataset as its first argument, followed by the <code>aes()</code> function that is used to map data to coordinates and other attributes.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="creating-your-first-graph.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))</span></code></pre></div>
<div class="figure"><span id="fig:empty-canvas"></span>
<img src="quant-methods_files/figure-html/empty-canvas-1.png" alt="An empty `ggplot` canvas." width="672" />
<p class="caption">
Figure 5.1: An empty <code>ggplot</code> canvas.
</p>
</div>
<p>As you can see in Figure <a href="creating-your-first-graph.html#fig:empty-canvas">5.1</a> the code above creates an “empty canvas” that has enough room to visualize our data. The x- and y-axes are adjusted to give room for graphical representations of the data. Next we need to add geometric shapes. These are functions that we add to the plot using the <code>+</code> sign. These functions all start with <code>geom_</code> and has and ending that describes the geoms, like point, line, etc.</p>
<p>We will add <code>geom_point()</code> to our empty canvas as plotted in Figure <a href="creating-your-first-graph.html#fig:empty-canvas">5.1</a>. The <code>geom_point</code> function <em>inherits</em> the mapping from from <code>ggplot()</code>. This means that we do not need to specify anything in <code>geom_point</code> at this stage.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="creating-your-first-graph.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure"><span id="fig:point-and-canvas"></span>
<img src="quant-methods_files/figure-html/point-and-canvas-1.png" alt="A `ggplot` canvas with points added." width="672" />
<p class="caption">
Figure 5.2: A <code>ggplot</code> canvas with points added.
</p>
</div>
<p>In Figure <a href="creating-your-first-graph.html#fig:point-and-canvas">5.2</a> we have added black points to each x- and y-coordinate representing <code>x</code> and <code>y</code> from our data set.</p>
<p>To extend the example we will add data to our dataset. In the code below, we create a new variable in the dataset using <code>$</code> effectively giving us a new column in the data. We use <code>rep("A", 5)</code> to replicate the letter <code>A</code> five times and the same for <code>B</code>. The <code>c()</code> function combines the two in a single vector. We can use <code>head(dat)</code> to see what we accomplished with these operations. The <code>head()</code> function <em>prints</em> the first six rows from the dataset.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="creating-your-first-graph.html#cb21-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">5</span>))</span>
<span id="cb21-2"><a href="creating-your-first-graph.html#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="creating-your-first-graph.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>##            x         y z
## 1  0.2139625  8.508462 A
## 2  0.4796581 11.843101 A
## 3  0.0878287 11.500109 A
## 4  0.4438585  4.982892 A
## 5 -0.3628379  3.918132 A
## 6  0.1226740 10.000532 B</code></pre>
<p>We can see that we have an additional variable <code>z</code> that contains <code>"A"</code> and <code>"B"</code>. This new variable can be used to add more information to the plot. Let’s say that we want to map the <code>z</code> variable to different colors. We do this by adding <code>color = z</code> to <code>aes</code>. This means that we want the z variable to determine colors.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="creating-your-first-graph.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> z)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure"><span id="fig:point-with-color"></span>
<img src="quant-methods_files/figure-html/point-with-color-1.png" alt="A `ggplot` canvas with colored points added." width="672" />
<p class="caption">
Figure 5.3: A <code>ggplot</code> canvas with colored points added.
</p>
</div>
<p>In Figure <a href="creating-your-first-graph.html#fig:point-with-color">5.3</a> we can see that different colors are used for the two letters <code>"A"</code> and <code>"B"</code>. Other attributes can also be specified like <code>shape</code>, <code>fill</code> or <code>size</code>. The <code>shape</code> specifies the appearance of the points. When we use use data to map to shapes, ggplot2 will start from the standard shape.</p>
<div class="figure"><span id="fig:shapes-in-r"></span>
<img src="quant-methods_files/figure-html/shapes-in-r-1.png" alt="Shapes in R" width="672" />
<p class="caption">
Figure 5.4: Shapes in R
</p>
</div>
<p>Possible shapes in the standard framework in R are shown in Figure <a href="creating-your-first-graph.html#fig:shapes-in-r">5.4</a>. We may use this information to either fix the shape of the points. Let’s say that instead of colored points we want filled points. We would change the <code>color = z</code> argument to <code>fill = z</code> instead and select a point shape that can be filled (shapes 21-25, see Figure <a href="creating-your-first-graph.html#fig:shapes-in-r">5.4</a>. Notice in the code below that <code>shape = 21</code> has been added to <code>geom_point()</code>. We have specified how points should be displayed.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="creating-your-first-graph.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> z)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>)</span></code></pre></div>
<div class="figure"><span id="fig:point-with-fill"></span>
<img src="quant-methods_files/figure-html/point-with-fill-1.png" alt="A `ggplot` canvas with filled points added." width="672" />
<p class="caption">
Figure 5.5: A <code>ggplot</code> canvas with filled points added.
</p>
</div>
<p>Since shape is an attribute it to can be mapped by data. If we want data to determine both shape and fill we could add this information in the <code>aes()</code> function by setting both <code>shape = z</code> and <code>fill = z</code>. We now have to specify what shapes ggplot should use in order to be sure we can combine both shapes and fill. We will use <code>scale_fill_manual</code> and <code>scale_shape_manual</code> to do this. These functions takes lets you specify different values for aesthetics. Notice that we removed <code>shape = 21</code> from the <code>geom_point()</code> function, but we added size to increase the size of the points.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="creating-your-first-graph.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> z, <span class="at">shape =</span> z)) <span class="sc">+</span> </span>
<span id="cb25-2"><a href="creating-your-first-graph.html#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb25-3"><a href="creating-your-first-graph.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb25-4"><a href="creating-your-first-graph.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>))</span></code></pre></div>
<div class="figure"><span id="fig:point-with-fill-and-shape"></span>
<img src="quant-methods_files/figure-html/point-with-fill-and-shape-1.png" alt="Data mapped to fill and shape, and size specified manually to override the default." width="672" />
<p class="caption">
Figure 5.6: Data mapped to fill and shape, and size specified manually to override the default.
</p>
</div>
</div>
<div id="different-geoms-using-real-data" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Different geoms using real data</h2>
<p>We have now seen that the basic <code>ggplot2</code> figure maps underlying data to coordinates and geometric representations, such as points. We will go further by using some real data. We will be using the <code>cyclingstudy</code> dataset from the <code>exscidata</code>-package. We will start by loading the data and select a few columns that we are interested in. By using <code>data("cyclingstudy")</code> we will load the data set that is part of the <code>exscidata</code>-package to our environment. By looking at the environment tab you can see that this operation adds a data set to the environment. It has 80 observations and 101 variables. Using the <code>glimpse()</code> function from <code>dplyr</code> (which is loaded by loading <code>tidyverse</code>) we will get an overview of all variables in the dataset. I have omitted the output from the code below</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="creating-your-first-graph.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data and have a first look</span></span>
<span id="cb26-2"><a href="creating-your-first-graph.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;cyclingstudy&quot;</span>)</span>
<span id="cb26-3"><a href="creating-your-first-graph.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(cyclingstudy)</span></code></pre></div>
<p>We will store a selected set of variables in a new object for ease of use. We will call this object <code>cycdat</code>. We select variables using the function with the very suitable name <code>select</code> where the first argument specifies the dataset, following arguments specifies what variables we want. Let’s say that we are interested in squat jump height. The <code>exscidata</code> package comes with descriptions of the datasets. By writing <code>?cyclingstudy</code> in your console you will see the description of the data in your help tab. Squat jump is recorded as <code>sj.max</code>, we select this variable together with <code>subject</code>, <code>group</code> and <code>timepoint</code> to create a smaller data set.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="creating-your-first-graph.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign a selected set of variables to a smaller data set</span></span>
<span id="cb27-2"><a href="creating-your-first-graph.html#cb27-2" aria-hidden="true" tabindex="-1"></a>cycdat <span class="ot">&lt;-</span> <span class="fu">select</span>(cyclingstudy, subject, group, timepoint, sj.max)</span>
<span id="cb27-3"><a href="creating-your-first-graph.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the data set</span></span>
<span id="cb27-4"><a href="creating-your-first-graph.html#cb27-4" aria-hidden="true" tabindex="-1"></a>cycdat</span></code></pre></div>
<pre><code>## # A tibble: 80 x 4
##    subject group timepoint sj.max
##      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;
##  1       1 INCR  pre         31.0
##  2       2 DECR  pre         31.6
##  3       3 INCR  pre         26.8
##  4       4 DECR  pre         29.2
##  5       5 DECR  pre         31.2
##  6       6 INCR  pre         34.2
##  7       7 MIX   pre         30.1
##  8       8 MIX   pre         32.8
##  9       9 MIX   pre         22.7
## 10      10 INCR  pre         29.7
## # ... with 70 more rows</code></pre>
<p>By printing the object we can see that we have a tibble of 80 rows and 4 columns. A tibble can to a large extent be regarded as a data frame, and we will use these words interchangeably. Tibbles are new in the sense that they are developed as part of the tidyverse <span class="citation">(<a href="references.html#ref-r4ds" role="doc-biblioref">Wickham and Grolemund 2017</a>)</span>.<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a> Printing a tibble will display the first 10 rows as we can see from the resulting output.</p>
<div id="a-plot-of-values-per-group" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> A plot of values per group</h3>
<p>Let’s say that we want to see how the values differs between groups. Boxplots are a good way to start as they will bring a standardized way of summarizing data. Boxplots can be plotted using the <code>geom_boxplot</code> function. Notice below that we put <code>group</code> on the x-axis (the first argument in the <code>aes</code> function) and <code>sj.max</code> on the y-axis. By doing so <code>ggplot</code> will make the x-axis discrete and the y-axis continuous.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="creating-your-first-graph.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a boxplot of all values per group</span></span>
<span id="cb29-2"><a href="creating-your-first-graph.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(group, sj.max)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<div class="figure"><span id="fig:sq-boxplot-simple"></span>
<img src="quant-methods_files/figure-html/sq-boxplot-simple-1.png" alt="Boxplot of all data per group from the cycling dataset." width="672" />
<p class="caption">
Figure 5.7: Boxplot of all data per group from the cycling dataset.
</p>
</div>
<p>We can layers of more geoms to the same plot. We might want to add individual data points also. <code>geom_jitter</code> might be a good place to start. This geom is good as it can be plotted over a group variable and points gets “jittered” or spread so we avoid overlap.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="creating-your-first-graph.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a boxplot of all values per group</span></span>
<span id="cb31-2"><a href="creating-your-first-graph.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(group, sj.max)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
<div class="figure"><span id="fig:sq-boxplot-jitter"></span>
<img src="quant-methods_files/figure-html/sq-boxplot-jitter-1.png" alt="Boxplot and jittered points of all data per group from the cycling dataset." width="672" />
<p class="caption">
Figure 5.8: Boxplot and jittered points of all data per group from the cycling dataset.
</p>
</div>
<p>Notice that we get warnings saying that there are some data missing, these are removed from the calculation of summary statistics in the boxplots and omitted from plotting the values as points.</p>
</div>
<div id="data-over-time-per-group-and-individual" class="section level3" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Data over time per group and individual</h3>
<p>In the data set we have a time variable consisting of the labels “pre,” “meso1,” “meso2” and “meso3.” When we load the data into R we do so without providing information about the order of these labels. R will put them in alphabetical order when order is required (as in a figure). If we want to plot these data in the right order we have to tell R that these data should have an order. We will convert the <code>timepoint</code> variable to a factor. Factors are variables that can contain more information than what is contained in each cell. Using the <code>factor</code> function we will set the order of the <code>timepoint</code> variable. We assign this transformation of the variable to its original place in the data frame.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="creating-your-first-graph.html#cb34-1" aria-hidden="true" tabindex="-1"></a>cycdat<span class="sc">$</span>timepoint <span class="ot">&lt;-</span> <span class="fu">factor</span>(cycdat<span class="sc">$</span>timepoint, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;meso1&quot;</span>, <span class="st">&quot;meso2&quot;</span>, <span class="st">&quot;meso3&quot;</span>))</span></code></pre></div>
<p>We are now ready to plot data over time, where the time variable is correctly ordered. Let’s use the boxplot again to plot all values over time.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="creating-your-first-graph.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a boxplot of all values per time point</span></span>
<span id="cb35-2"><a href="creating-your-first-graph.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(timepoint, sj.max)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<div class="figure"><span id="fig:sq-boxplot"></span>
<img src="quant-methods_files/figure-html/sq-boxplot-1.png" alt="Boxplot of all data per time-point from the cycling dataset." width="672" />
<p class="caption">
Figure 5.9: Boxplot of all data per time-point from the cycling dataset.
</p>
</div>
<p>We do not see any great tendencies in the whole data set. To further explore the data we might want to have different boxes per group per time. We can accomplish this by adding <code>fill = group</code> to our <code>aes</code> function.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="creating-your-first-graph.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a boxplot of all values per group over time</span></span>
<span id="cb37-2"><a href="creating-your-first-graph.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(timepoint, sj.max, <span class="at">fill =</span> group)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<div class="figure"><span id="fig:sq-boxplot-time"></span>
<img src="quant-methods_files/figure-html/sq-boxplot-time-1.png" alt="Boxplot of all data per time-point and group from the cycling dataset." width="672" />
<p class="caption">
Figure 5.10: Boxplot of all data per time-point and group from the cycling dataset.
</p>
</div>
<p>This is possible because <code>geom_boxplots</code> can be filled. The same separation of groups would have been accomplished using <code>color = group</code>, however, then the boxes would get different border colors instead. You might have noticed that the boxplots do not contain all the data, a few data points are outside 1.5 IQR (interquartile range). This, by standard definitions, defines the data point as an “outlier.”</p>
<p>As mentioned above, boxplots does some summarizing and not all data is shown. To explore further we might want to track every participant. To do this we have to tell <code>ggplot</code> on what factor to group the data. In <code>aes()</code> the group argument let’s you connect lines based on some grouping variable, in our case it will be <code>subject</code>. We will use a line to connect each participants score over time. Using <code>color = group</code> will additionally give every line a different color depending on which group it belongs to.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="creating-your-first-graph.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a line plot of all values per participant over time, color per group</span></span>
<span id="cb39-2"><a href="creating-your-first-graph.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(timepoint, sj.max, <span class="at">color =</span> group, <span class="at">group =</span> subject)) <span class="sc">+</span> </span>
<span id="cb39-3"><a href="creating-your-first-graph.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<div class="figure"><span id="fig:sq-ind-data"></span>
<img src="quant-methods_files/figure-html/sq-ind-data-1.png" alt="Boxplot of all data per time-point and group from the cycling dataset." width="672" />
<p class="caption">
Figure 5.11: Boxplot of all data per time-point and group from the cycling dataset.
</p>
</div>
<p>In Figure <a href="creating-your-first-graph.html#fig:sq-ind-data">5.11</a> each line represents a participant, different colors represents different groups.</p>
</div>
<div id="titles-and-labels" class="section level3" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Titles and labels</h3>
<p>Often we need to add information to the plot to better communicate its message. Such information could be appropriate titles on axes and legends and extra text needed to explain aspects of the plot. Using the <code>labs()</code> function we can add information that will replace variable names that are being used for all variables that have been mapped in the figure. In the figure below we will start by adding better axis titles. This information goes into <code>x</code> and <code>y</code> in <code>labs()</code> which simply changes the titles of the x- and y-axis.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="creating-your-first-graph.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a line plot of all values per participant over time, color per group</span></span>
<span id="cb41-2"><a href="creating-your-first-graph.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(timepoint, sj.max, <span class="at">color =</span> group, <span class="at">group =</span> subject)) <span class="sc">+</span> </span>
<span id="cb41-3"><a href="creating-your-first-graph.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb41-4"><a href="creating-your-first-graph.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time-point&quot;</span>,</span>
<span id="cb41-5"><a href="creating-your-first-graph.html#cb41-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Squat jump height (cm)&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<div class="figure"><span id="fig:sq-ind-data-axis-title"></span>
<img src="quant-methods_files/figure-html/sq-ind-data-axis-title-1.png" alt="Boxplot of all data per time-point and group from the cycling dataset." width="672" />
<p class="caption">
Figure 5.12: Boxplot of all data per time-point and group from the cycling dataset.
</p>
</div>
<p>The resulting Figure <a href="creating-your-first-graph.html#fig:sq-ind-data-axis-title">5.12</a> now have better titles for each axis. Notice in the code above that titles needs to be specified with quotation marks. This is a tricky aspect of R, if we wold have omitted the quotation marks we would have told R to look for objects by the name of e.g. <code>Time-point</code>, and this would actually mean that we tryed to subtract <code>time</code> from <code>point</code> since <code>-</code> is interpreted as a minus sign.</p>
<p>We might want to add information to the legend also. Since we specified <code>color = group</code> in the <code>aes()</code> function, the same can be manipulated in <code>labs</code>. Lets just add a capital G.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="creating-your-first-graph.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(timepoint, sj.max, <span class="at">color =</span> group, <span class="at">group =</span> subject)) <span class="sc">+</span> </span>
<span id="cb43-2"><a href="creating-your-first-graph.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb43-3"><a href="creating-your-first-graph.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time-point&quot;</span>,</span>
<span id="cb43-4"><a href="creating-your-first-graph.html#cb43-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Squat jump height (cm)&quot;</span>, </span>
<span id="cb43-5"><a href="creating-your-first-graph.html#cb43-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Group&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<div class="figure"><span id="fig:sq-ind-data-axis-title2"></span>
<img src="quant-methods_files/figure-html/sq-ind-data-axis-title2-1.png" alt="Boxplot of all data per time-point and group from the cycling dataset." width="672" />
<p class="caption">
Figure 5.13: Boxplot of all data per time-point and group from the cycling dataset.
</p>
</div>
<p>We still have the original labels for the tim variable. Remember that we used the <code>factor</code> function above to set the order of the labels. Actually we specified the “levels” of the factor. We can use the same function to add better “labels.” In the code below, I will first change the variable in the dataset and then use the exact same code for the plot.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="creating-your-first-graph.html#cb45-1" aria-hidden="true" tabindex="-1"></a>cycdat<span class="sc">$</span>timepoint <span class="ot">&lt;-</span> <span class="fu">factor</span>(cycdat<span class="sc">$</span>timepoint, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;meso1&quot;</span>, <span class="st">&quot;meso2&quot;</span>, <span class="st">&quot;meso3&quot;</span>), </span>
<span id="cb45-2"><a href="creating-your-first-graph.html#cb45-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Pre-training&quot;</span>, <span class="st">&quot;Meso-cycle 1&quot;</span>, <span class="st">&quot;Meso-cycle 2&quot;</span>, <span class="st">&quot;Meso-cycle 3&quot;</span>))</span>
<span id="cb45-3"><a href="creating-your-first-graph.html#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="creating-your-first-graph.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(timepoint, sj.max, <span class="at">color =</span> group, <span class="at">group =</span> subject)) <span class="sc">+</span> </span>
<span id="cb45-5"><a href="creating-your-first-graph.html#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb45-6"><a href="creating-your-first-graph.html#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time-point&quot;</span>,</span>
<span id="cb45-7"><a href="creating-your-first-graph.html#cb45-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Squat jump height (cm)&quot;</span>, </span>
<span id="cb45-8"><a href="creating-your-first-graph.html#cb45-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Group&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<div class="figure"><span id="fig:sq-ind-data-axis-title3"></span>
<img src="quant-methods_files/figure-html/sq-ind-data-axis-title3-1.png" alt="Boxplot of all data per time-point and group from the cycling dataset." width="672" />
<p class="caption">
Figure 5.14: Boxplot of all data per time-point and group from the cycling dataset.
</p>
</div>
<p>The same goes for the group variable. You can try to change the levels and labels of the grouping variable to make it more descriptive. You can type <code>?cyclingstudy</code> in your console to read about the group variable and then use this infomation to write better labels using the <code>factor</code> function. In the factor function, the first argument is the variable you want to use as basis of your new factor, the second argument you need to specify is <code>levels</code> which sets the order and lastly you will need to set the labels for each level using <code>labels =</code>. If you write <code>?factor</code> in your console you will get the help pages for the <code>factor</code> function.</p>
<a id="displayText" href="javascript:toggle(1);">Click here to display a possible solution</a>
<div id="toggleText1" style="display: none">
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="creating-your-first-graph.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the grouping variable</span></span>
<span id="cb47-2"><a href="creating-your-first-graph.html#cb47-2" aria-hidden="true" tabindex="-1"></a>cycdat<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(cycdat<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;DECR&quot;</span>, <span class="st">&quot;INCR&quot;</span>, <span class="st">&quot;MIX&quot;</span>), </span>
<span id="cb47-3"><a href="creating-your-first-graph.html#cb47-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Decreased</span><span class="sc">\n</span><span class="st">intensity&quot;</span>, </span>
<span id="cb47-4"><a href="creating-your-first-graph.html#cb47-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&quot;Increased</span><span class="sc">\n</span><span class="st">intensity&quot;</span>, </span>
<span id="cb47-5"><a href="creating-your-first-graph.html#cb47-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&quot;Mixed</span><span class="sc">\n</span><span class="st">intensity&quot;</span>))</span>
<span id="cb47-6"><a href="creating-your-first-graph.html#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="creating-your-first-graph.html#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the data as before with the new information added</span></span>
<span id="cb47-8"><a href="creating-your-first-graph.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(timepoint, sj.max, <span class="at">color =</span> group, <span class="at">group =</span> subject)) <span class="sc">+</span> </span>
<span id="cb47-9"><a href="creating-your-first-graph.html#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb47-10"><a href="creating-your-first-graph.html#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time-point&quot;</span>,</span>
<span id="cb47-11"><a href="creating-your-first-graph.html#cb47-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Squat jump height (cm)&quot;</span>, </span>
<span id="cb47-12"><a href="creating-your-first-graph.html#cb47-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Periodization strategy&quot;</span>)</span></code></pre></div>
<p>Note: Adding <code>\n</code> in the the text string breaks the line to get two rows.</p>
</div>
</div>
<div id="annotations" class="section level3" number="5.5.4">
<h3><span class="header-section-number">5.5.4</span> Annotations</h3>
<p>Annotation may become handy when you want to add elements to the graph that is not in the data set. Using ggplot2 annotations are added using the <code>annotate()</code> function. This function first needs to be specified with a geom, these are commonly text or lines or segments. In the code chunk below are several examples of annotations. Firts I save the plot as an object called <code>myplot</code> and then add different annotations to it.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="creating-your-first-graph.html#cb48-1" aria-hidden="true" tabindex="-1"></a>myplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(timepoint, sj.max, <span class="at">color =</span> group, <span class="at">group =</span> subject)) <span class="sc">+</span> </span>
<span id="cb48-2"><a href="creating-your-first-graph.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb48-3"><a href="creating-your-first-graph.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time-point&quot;</span>,</span>
<span id="cb48-4"><a href="creating-your-first-graph.html#cb48-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Squat jump height (cm)&quot;</span>, </span>
<span id="cb48-5"><a href="creating-your-first-graph.html#cb48-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Periodization strategy&quot;</span>) </span>
<span id="cb48-6"><a href="creating-your-first-graph.html#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="creating-your-first-graph.html#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="creating-your-first-graph.html#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># A text annotation</span></span>
<span id="cb48-9"><a href="creating-your-first-graph.html#cb48-9" aria-hidden="true" tabindex="-1"></a>myplot <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">37</span>, <span class="at">label =</span> <span class="st">&quot;This is an annotation&quot;</span>)</span>
<span id="cb48-10"><a href="creating-your-first-graph.html#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="creating-your-first-graph.html#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co"># A line/segment </span></span>
<span id="cb48-12"><a href="creating-your-first-graph.html#cb48-12" aria-hidden="true" tabindex="-1"></a>myplot <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">25</span>, <span class="at">yend =</span> <span class="dv">35</span>,  <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>You can copy the code and run it yourself to see the results. <code>annotate</code> is documented <a href="https://ggplot2.tidyverse.org/reference/annotate.html">here</a> but documentation can also be accessed by typing <code>?annotate</code> in your console. Try to read the documentation and add a transparent rectangle to a previous plot.</p>
<a id="displayText" href="javascript:toggle(2);">Click here for a solution</a>
<div id="toggleText2" style="display: none">
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="creating-your-first-graph.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the grouping variable</span></span>
<span id="cb49-2"><a href="creating-your-first-graph.html#cb49-2" aria-hidden="true" tabindex="-1"></a>cycdat<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(cycdat<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;DECR&quot;</span>, <span class="st">&quot;INCR&quot;</span>, <span class="st">&quot;MIX&quot;</span>), </span>
<span id="cb49-3"><a href="creating-your-first-graph.html#cb49-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Decreased</span><span class="sc">\n</span><span class="st">intensity&quot;</span>, </span>
<span id="cb49-4"><a href="creating-your-first-graph.html#cb49-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&quot;Increased</span><span class="sc">\n</span><span class="st">intensity&quot;</span>, </span>
<span id="cb49-5"><a href="creating-your-first-graph.html#cb49-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&quot;Mixed</span><span class="sc">\n</span><span class="st">intensity&quot;</span>))</span>
<span id="cb49-6"><a href="creating-your-first-graph.html#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="creating-your-first-graph.html#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the data as before with the new information added</span></span>
<span id="cb49-8"><a href="creating-your-first-graph.html#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(timepoint, sj.max, <span class="at">color =</span> group, <span class="at">group =</span> subject)) <span class="sc">+</span> </span>
<span id="cb49-9"><a href="creating-your-first-graph.html#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb49-10"><a href="creating-your-first-graph.html#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time-point&quot;</span>,</span>
<span id="cb49-11"><a href="creating-your-first-graph.html#cb49-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Squat jump height (cm)&quot;</span>, </span>
<span id="cb49-12"><a href="creating-your-first-graph.html#cb49-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Periodization strategy&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-13"><a href="creating-your-first-graph.html#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># A rectangular annotation (alpha = 0.4 makes the rectangle transparent)</span></span>
<span id="cb49-14"><a href="creating-your-first-graph.html#cb49-14" aria-hidden="true" tabindex="-1"></a> <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">ymin =</span> <span class="dv">30</span>, <span class="at">ymax =</span> <span class="dv">35</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>)</span></code></pre></div>
<p>Note: Adding <code>\n</code> in the the text string breaks the line to get two rows.</p>
</div>
</div>
</div>
<div id="themes" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Themes</h2>
<p>Themes in <code>ggplot2</code> can be used to change everything else about the plot concerning text, colors etc. <code>ggplot2</code> has some built in themes that are easily activated by adding them to the plot. For example the <code>theme_bw()</code> function will change the theme to a black and white one as in the figure below.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="creating-your-first-graph.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(timepoint, sj.max, <span class="at">color =</span> group, <span class="at">group =</span> subject)) <span class="sc">+</span> </span>
<span id="cb50-2"><a href="creating-your-first-graph.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb50-3"><a href="creating-your-first-graph.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time-point&quot;</span>,</span>
<span id="cb50-4"><a href="creating-your-first-graph.html#cb50-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Squat jump height (cm)&quot;</span>, </span>
<span id="cb50-5"><a href="creating-your-first-graph.html#cb50-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Group&quot;</span>) <span class="sc">+</span> </span>
<span id="cb50-6"><a href="creating-your-first-graph.html#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<div class="figure"><span id="fig:bw-theme"></span>
<img src="quant-methods_files/figure-html/bw-theme-1.png" alt="A figure using the black and white theme from `theme_bw`." width="672" />
<p class="caption">
Figure 5.15: A figure using the black and white theme from <code>theme_bw</code>.
</p>
</div>
<p>A collection of built in themes are documented <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">here</a>. Individual components of the theme can also be changed using the <code>theme()</code> function. There is a long list of theme components that can be changed using this function. The list can be found <a href="https://ggplot2.tidyverse.org/reference/theme.html">here</a>.<br />
If we put the <code>theme</code> function last in the <code>ggplot</code> call we will modify one part of the existing theme. Let’s say that we want to change the color of the text on the x axis.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="creating-your-first-graph.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycdat, <span class="fu">aes</span>(timepoint, sj.max, <span class="at">color =</span> group, <span class="at">group =</span> subject)) <span class="sc">+</span> </span>
<span id="cb52-2"><a href="creating-your-first-graph.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb52-3"><a href="creating-your-first-graph.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time-point&quot;</span>,</span>
<span id="cb52-4"><a href="creating-your-first-graph.html#cb52-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Squat jump height (cm)&quot;</span>, </span>
<span id="cb52-5"><a href="creating-your-first-graph.html#cb52-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Group&quot;</span>) <span class="sc">+</span> </span>
<span id="cb52-6"><a href="creating-your-first-graph.html#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb52-7"><a href="creating-your-first-graph.html#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<div class="figure"><span id="fig:bw-theme-changed"></span>
<img src="quant-methods_files/figure-html/bw-theme-changed-1.png" alt="A figure using the black and white theme from `theme_bw`." width="672" />
<p class="caption">
Figure 5.16: A figure using the black and white theme from <code>theme_bw</code>.
</p>
</div>
<p>The component <code>axis.text.x</code> can be modified using a function that changes appearance of text components, namely <code>element_text</code>. Similarly, other components are changed with specific functions for lines and rectangular shapes (see the help pages for <code>theme</code>.</p>
</div>
<div id="test-your-understandning" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Test your understandning</h2>
<p>In this section you can try to implement what we have discussed above An example solution exists below each figure by press of button.</p>
<p>In Figure <a href="creating-your-first-graph.html#fig:example-fig-1">5.17</a>, I have used the VO<sub>2max</sub> data from the <code>cyclingstudy</code> dataset. I have made changes to the time variable (<code>timepoint</code>) to make the labels better. I have added a title to the figure and changed the appearance of the text. I will use an extra package called (ggtext)[<a href="https://wilkelab.org/ggtext/index.html" class="uri">https://wilkelab.org/ggtext/index.html</a>] to make it possible to use markdown syntaxt in axis labels. In order to use <code>ggtext</code> you have to install it from CRAN.</p>
<div class="figure"><span id="fig:example-fig-1"></span>
<img src="quant-methods_files/figure-html/example-fig-1-1.png" alt="Example figure 1" width="672" />
<p class="caption">
Figure 5.17: Example figure 1
</p>
</div>
<a id="displayText" href="javascript:toggle(3);">Click for a solution</a>
<div id="toggleText3" style="display: none">
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="creating-your-first-graph.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the package ggtext to make markdown avalable in axis labels.</span></span>
<span id="cb54-2"><a href="creating-your-first-graph.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext) </span>
<span id="cb54-3"><a href="creating-your-first-graph.html#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="creating-your-first-graph.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For ease of use I save a smaller dataset in a new object</span></span>
<span id="cb54-5"><a href="creating-your-first-graph.html#cb54-5" aria-hidden="true" tabindex="-1"></a>cycdat <span class="ot">&lt;-</span> <span class="fu">select</span>(cyclingstudy, subject, timepoint, VO2.max)</span>
<span id="cb54-6"><a href="creating-your-first-graph.html#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="creating-your-first-graph.html#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the labels of the time variable</span></span>
<span id="cb54-8"><a href="creating-your-first-graph.html#cb54-8" aria-hidden="true" tabindex="-1"></a>cycdat<span class="sc">$</span>timepoint <span class="ot">&lt;-</span> <span class="fu">factor</span>(cycdat<span class="sc">$</span>timepoint, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;meso1&quot;</span>, <span class="st">&quot;meso2&quot;</span>, <span class="st">&quot;meso3&quot;</span>), </span>
<span id="cb54-9"><a href="creating-your-first-graph.html#cb54-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Pre-training&quot;</span>, <span class="st">&quot;Meso-cycle 1&quot;</span>, <span class="st">&quot;Meso-cycle 2&quot;</span>, <span class="st">&quot;Meso-cycle 3&quot;</span>))</span>
<span id="cb54-10"><a href="creating-your-first-graph.html#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="creating-your-first-graph.html#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="creating-your-first-graph.html#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co"># create the basic plot</span></span>
<span id="cb54-13"><a href="creating-your-first-graph.html#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="creating-your-first-graph.html#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cycdat, <span class="fu">aes</span>(timepoint, VO2.max, <span class="at">group =</span> subject)) <span class="sc">+</span> </span>
<span id="cb54-15"><a href="creating-your-first-graph.html#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines to connect dots. Putting the lines first and plotting points on top</span></span>
<span id="cb54-16"><a href="creating-your-first-graph.html#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb54-17"><a href="creating-your-first-graph.html#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add points foe each participant/time</span></span>
<span id="cb54-18"><a href="creating-your-first-graph.html#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb54-19"><a href="creating-your-first-graph.html#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="creating-your-first-graph.html#cb54-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding correct axis titles and a figure title</span></span>
<span id="cb54-21"><a href="creating-your-first-graph.html#cb54-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time-point&quot;</span>, </span>
<span id="cb54-22"><a href="creating-your-first-graph.html#cb54-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;VO&lt;sub&gt;2max&lt;/sub&gt; (ml min&lt;sup&gt; -1&lt;/sup&gt;)&quot;</span>, </span>
<span id="cb54-23"><a href="creating-your-first-graph.html#cb54-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Maximal aerobic power in response to systematic training in trained cyclists&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-24"><a href="creating-your-first-graph.html#cb54-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-25"><a href="creating-your-first-graph.html#cb54-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Changing the text rendering using element_markdown from the ggtext package.</span></span>
<span id="cb54-26"><a href="creating-your-first-graph.html#cb54-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_markdown</span>(<span class="at">size =</span> <span class="dv">12</span>)) </span></code></pre></div>
<p>Note: Adding <code>\n</code> in the the text string breaks the line to get two rows.</p>
</div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="16">
<li id="fn16"><p>See <a href="https://r4ds.had.co.nz/tibbles.html">Chapter 10 in R for data science</a><a href="creating-your-first-graph.html#fnref16" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="installing-and-starting-up-r-and-r-studio.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="wrangling-data-to-create-your-first-table.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["quant-methods.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
